====================================
INSTRUCTIONS TO ADD iOS BUILD WORKFLOW
====================================

Go to Bitrise → Your App → Workflows → Edit Workflow

Then add a NEW WORKFLOW called "ios_build" with these steps:

------------------------------------
STEP 1: Git Clone Repository
------------------------------------
Use: git-clone@8

------------------------------------
STEP 2: Install Node.js
------------------------------------
Use: script@1
Title: Install Node.js
Content:
#!/usr/bin/env bash
set -euxo pipefail

export ASDF_NODEJS_LEGACY_FILE_DYNAMIC_STRATEGY=latest_installed
envman add --key ASDF_NODEJS_LEGACY_FILE_DYNAMIC_STRATEGY --value latest_installed

pushd "${NODEJS_PROJECT_DIR:-.}" > /dev/null
asdf install nodejs
popd > /dev/null

------------------------------------
STEP 3: Restore NPM Cache
------------------------------------
Use: restore-npm-cache@2

------------------------------------
STEP 4: npm install
------------------------------------
Use: npm@1
Title: npm install
Command: install

------------------------------------
STEP 5: Build web assets
------------------------------------
Use: npm@1
Title: Build web assets
Command: run build

------------------------------------
STEP 6: Install CocoaPods dependencies
------------------------------------
Use: cocoapods-install@2
Inputs:
- source_root_path: $BITRISE_SOURCE_DIR/ios/App

------------------------------------
STEP 7: Sync Capacitor
------------------------------------
Use: script@1
Title: Sync Capacitor iOS
Content:
#!/usr/bin/env bash
set -ex
npx cap sync ios

------------------------------------
STEP 8: iOS Auto Provision with App Store Connect API
------------------------------------
Use: ios-auto-provision-appstoreconnect@1
Inputs:
- distribution_type: app-store
- configuration: Release

------------------------------------
STEP 9: Xcode Archive & Export
------------------------------------
Use: xcode-archive@5
Inputs:
- project_path: $BITRISE_SOURCE_DIR/ios/App/App.xcworkspace
- scheme: App
- distribution_method: app-store
- automatic_code_signing: api-key

------------------------------------
STEP 10: Deploy to Bitrise.io
------------------------------------
Use: deploy-to-bitrise-io@2

------------------------------------
STEP 11: Save NPM Cache
------------------------------------
Use: save-npm-cache@1

------------------------------------
WORKFLOW SETTINGS
------------------------------------
Stack: Xcode 26.2 with edge updates (or latest)
Machine Type: macOS M2 Pro Large (or your preference)

------------------------------------
TRIGGERS (Optional)
------------------------------------
Set trigger to run on branch: ios-release
OR run manually

====================================
BEFORE BUILDING - REQUIRED!
====================================

You MUST configure Apple Code Signing:

Option A - App Store Connect API Key (Recommended):
1. Go to Bitrise → Code Signing
2. Add App Store Connect API Key
3. Upload your .p8 file from Apple Developer

Option B - Manual Certificates:
1. Go to Bitrise → Code Signing → iOS
2. Upload .p12 certificate
3. Upload provisioning profile

====================================
